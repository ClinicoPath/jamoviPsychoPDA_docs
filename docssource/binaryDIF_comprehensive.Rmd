---
title: "Binary Differential Item Functioning - Comprehensive"
nickname: binaryDIFcomprehensive
topic: binaryDIF
category: DIF
output: 
  html_document:
     includes:
         in_header: ganalytics.txt
     toc: true
     toc_float:
        collapsed: false
---

```{r echo=FALSE,results='hide'}
source("../R/functions.R")
```

The following is a comprehensive overview of the available options in the BinaryDIF module. For information on getting started, see here:

`r list_pages(nickname = "binaryDIFintroduction")`

# DIF Analysis

## Background

In any discussion of differential item functioning, it is important to note that DIF is not synonymous with bias or fairness. Questions of fairness in tests and measures are directly related to the use of an individual’s score on that test or measure. For example, if men and women from a given nation receive different levels of training in speaking English, whether and how scores on a speaking proficiency test should be used in making immigration decisions is a question of fairness. On the other hand, DIF analysis seeks to find out if men and women from that nation _who are equally proficient in spite of unfair circumstances_ have an equal probability of answering a given test item correctly. Thus, DIF analysis is a step removed from external questions of bias and fairness in test decisions, but is instead concerned with the internal functioning of the test and test items. However, should a test or test item be found to exhibit DIF in favour of one group over another, this result may be relevant to any decision making process based on test scores, as well as a discussion of fairness regarding the use of that test.

Logistic regression, the method used in this module, is among the most popular methods for detecting DIF for several reasons (see @mosesComparisonStrategiesEstimating2010 and @magisGeneralFrameworkPackage2010 for additional discussion). Logistic regression can be used to detect both uniform and non-uniform DIF with two or more groups, and can be used in either an IRT or non-IRT context. To date, however, no software has been developed which facilitates DIF analysis in a way which is widely accessible(fn). 

## Calculations

The DIF module performs DIF analysis on dichotomously scored items using binary grouping variables(fn) and either total-score matching or matching based on a supplied variable. The following explanation of the analysis will use an example where the grouping variable β₁ is a binary classification (0, 1) and the matching variable is a latent construct-level variable θ. This example is the case where we are simultaneously assessing for both uniform or non-uniform DIF.

Using a GLIM model, items are fit first with a baseline model containing both the main effects and interaction effect:

Logit of endorsement = β₀ + β₁ + θ + (β₁ * θ)

A second model containing  only the main effect of the matching variable is then fit:

Logit of endorsement = β₀ + θ 

The reduction in model deviance is then calculated between the baseline and secondary models (ΔD). If ΔD is not statistically significant (at a level specifiable by the user and using either the Wald test of joint significance or a likelihood ratio test), then the item is not exhibiting DIF. If ΔD is significant, the item is flagged as exhibiting DIF and the effect size for ΔD may be assessed.

## Options

<img src="DIF/analysisVariables.png  " class="img-responsive" alt="">

1.      title: Items                   type: Variables

`Items` must be a series (vector) of names referencing columns in the data containing exactly two unique values, such as [0, 1]. The data will be converted to integer type prior to analysis using `jmvcore::toNumeric()`.

2.      title: Grouping Variable       type: Variable

`Grouping Variable` must be a single name referencing a column in the data containing at least two unique values, such as [0, 1].  The data will be converted to factor type prior to analysis using `base:as.factor()`.

The value of the first row in the column will be coded as `Group A`, and all rows containing non-`Group A` values will be coded as `Group B`. If more than two unique values are present in the column, all values different from the value of the first row will be collapsed into the same `Group B`. This restriction will be removed in a future version of the module, but is necessary for several aspects of the current version to perform.

3.      title: Matching Variable       type: Variable

`Matching Variable` is an optional argument. This is the value which is used in the regression equations to account for differences in, for example, proficiency, levels of a latent contstruct, or some other psychosocial factor. If it is left empty, subjects will be matched on the Total Score, calculated internally by the module. This variable must be `numeric`.

4.      title: Anchor Items            type: Variables

`Anchor Items` is an optional argument. If provided, `Matching Variable` must be left empty. `Anchor Items` must be a series (vector) of names referencing columns in the data which are considered to be 'gold standard'. That is, containing no DIF. These items will be used in calculating the subject Total Score, but are not assessed for DIF. See `Purification` below for more details.

<img src="DIF/analysis.png  " class="img-responsive" alt="">


5.      title: Group Type
    	  options:
        	title: Discrete Groups
        	title: Continuous Groups
        	
`Group Type` must take either "Discrete Groups" or "Continuous Groups" as its value. Discrete groups are a grouping variable such as binary gender classifications, or national identity. Continuous Groups are a grouping variable such as age.

6.      title: Evaluation Scale
    	  options:
        	  title: Zumbo-Thomas
        	  title: Jodoin-Gierl

`Evaluation Scale` refers to the classification scheme for DIF effect sizes on the Naeglekirke’s R^2 (Δ R^2) scale. 

12.      title: Type
    	  options:
        - title: Uniform DIF
        - title: Non-Uniform DIF
        - title: Uniform and Non-Uniform DIF
        
`Type` refers to the type of DIF to be assessed for. The default, `Uniform and Non-Uniform DIF` will check simultaneously for significant main and interaction effects.
        
13.     title: Flagging Criterion
    	  options:
    	  - name: "Wald"
    	  - name: "LRT"
    	  
`Flagging Criterion` refers to what test should be used in testing for statistical significance of regression coefficients.
    	  
14.     title: Alpha      type: Number

`Alpha` is the desired Type-I error rate for statistical significance tests.r

15.     title: Item Purification

16.     title: Number of Iterations      type: Number

`Number of Iterations` is the maximum number of purification iterations to be used if `Item Purification` is selected.

17.     title: P-value Adjustment method
    	  options: 
        	- name: bonferroni
        	- name: holm
        	- name: hochberg
        	- name: hommel
        	- name: BH
        	- name: BY
        	- name: none
        	
`P-value Adjustment method` is the method of correction for multiple comparisons desired:

The adjustment methods include the Bonferroni correction ("bonferroni") in which the p-values are multiplied by the number of comparisons. Less conservative corrections are also included by Holm (1979) ("holm"), Hochberg (1988) ("hochberg"), Hommel (1988) ("hommel"), Benjamini & Hochberg (1995) ("BH" or its alias "fdr"), and Benjamini & Yekutieli (2001) ("BY"), respectively. A pass-through option ("none") is also included. The set of methods are contained in the p.adjust.methods vector for the benefit of methods that need to have the method as an option and pass it on to p.adjust.

The first four methods are designed to give strong control of the family-wise error rate. There seems no reason to use the unmodified Bonferroni correction because it is dominated by Holm's method, which is also valid under arbitrary assumptions.

Hochberg's and Hommel's methods are valid when the hypothesis tests are independent or when they are non-negatively associated (Sarkar, 1998; Sarkar and Chang, 1997). Hommel's method is more powerful than Hochberg's, but the difference is usually small and the Hochberg p-values are faster to compute.

The "BH" (aka "fdr") and "BY" method of Benjamini, Hochberg, and Yekutieli control the false discovery rate, the expected proportion of false discoveries amongst the rejected hypotheses. The false discovery rate is a less stringent condition than the family-wise error rate, so these methods are more powerful than the others.

Note that you can set n larger than length(p) which means the unobserved p-values are assumed to be greater than all the observed p for "bonferroni" and "holm" methods and equal to 1 for the other methods.

# Design Analysis

## Background

Type-S and Type-M errors are post-data calculations that rely on the observed data and an estimated “true” effect size which is determined via information external to the study at hand, such as literature review and subject-matter expertise (@gelman2014, p. 643). The Type-S error rate is the probability that the observed estimate of the effect size will have the wrong sign (I.e. - vs. +), if statistically significantly different from zero (@gelman2014, p. 643). Type-M error, or the exaggeration ratio, is the expectation of the absolute value of the effect size divided by the hypothesized true effect size, if statistically significantly different from zero (@gelman2014, p. 643). In other words, it is the factor by which the observed effect size might be expected to be exaggerated given the assumption of the provided true effect size. 

To give the reader an sense for assessing Type-S and Type-M errors, understanding their intimate relationship between power is helpful. In the cases where True Power is 0 and 1, Type-S error will be 0.5 and 0, and Type-M error will be infinite and 1, respectively. A Type-S error of 0.5 means that their is a 50% probability that the observed effect size is in the opposite direction of the True effect size, and a Type-M error of 1 means that the observed effect size is precisely what is expected (under replication) of a statistically significant result.

In the context of DIF analysis, the effect size most commonly encountered (and that referenced by the Zumbo-Thomas scale) is a derived statistic - The change in Naeglekirke’s R^2 (Δ R^2) between the baseline and full models. Because this number will always be positive, it is not possible to compute a Type-S error rate for this statistic. However, in most contexts, the precise magnitude of the true DIF effect is of great interest, and it is here that the Type-M error rate is of great interest. This is because decisions made regarding the fate of an item, such as whether or not it is to be used in a test, or whether a test as a whole is admissible for certain uses, depends almost entirely on the criteria used to decide whether an item is exhibiting “too much DIF”.

## Calculation

Calculating the Type-M error rate for a derived statistic is done via a bootstrapping process which generates an empirical distribution for the Δ R^2 for each item. The design analysis is then carried out according to the same principles as those laid out in Gelman & Carlin (2014) using three hypothesized true correlations. The hypothesized true correlations correspond to the level thresholds of the zumbo-Thomas DIF evaluation scale(fn): 0 (Null/Negligble DIF), 0.13 (Moderate DIF), 0.26 (Large DIF).

<img src="DIF/designAnalysis.png  " class="img-responsive" alt="">

## Options

7.      title: Design Analysis

`Design Analysis` is a `True`/`False` option, defaulted to `False`. This can be quite computationally intensive. If this option is selected, and then another option is changed, the module will incorporate the change as soon as possible, but several embedded loops mean that there may be a delay before you see the change take effect.

8.      title: Constant Alpha

`Constant Alpha` is a `True`/`False` option, defaulted to `True`. This option refers to whether or not you want to perform a post-data design analysis using the same alpha as in the DIF analysis, or using the minimum alpha required for significance for _all_ items.

9.      title: Bootstrap N      type: Number

`Bootstrap N` refers to the number of bootstrap replications to be used in creating the empirical distribution for Δ R^2. This is defaulted to `1000` as a balance between computation time and precision. Lower numbers will allow faster exploration, but will provide less stable estimates.

10.     title: Observed Power

`Observed Power` is a `True`/`False` option, defaulted to `False`. Toggling this option reveals the column showing the Empirical Observed Power. This is defaulted to `False` because its interpretation can be confusing, and will not always provide useful information. N.B. The Empirical Observed Power _can_ equal 1 or 0.

11.     title: Hypothesized True Effect Size      type: String

`Hypothesized True Effect Size` is used to perform design analysis using a non-default hypothesized true effect. If left blank, the analysis will be performed at each of the thresholds of the `DIF Flag Scale` selected above.

# Item Response Curves

## Details

<img src="DIF/ICC.png  " class="img-responsive" alt="">

18.     title: Item Response Curves based on Logistic Regression    type: Variables

`Item Respnse Curves` is a list (vector) of names referring to columns in the data selected for DIF analysis for which logistic regression Item Response Curves should be produced.

# Examples

Some worked out examples of analyses carried out with jamovi PsychoPDA are posted here (more to come)

`r include_examples("binaryDIF")`

`r issues()`